#!/bin/bash

# If we are on the master branch
if [ 'git branch'="master" ]
then
  # Build CSS and JS
  npm run build

  # Add travis identification
  git config user.email "travis@knowledge-map.org"
  git config user.name "travis"

  # Commit the builds
  git add dist/* -f
  NEW_DISTS=$?
  
  # If there are new distribution files
  if [ $NEW_DISTS -eq 0 ]
  then
    # Commit the distributions
    git commit -m "Updated distribution files"

    # Update the version
    # also update the git version tags
    npm version patch

    # Update the repo
    git push --tags https://github.com/knowledge-map/cartographer.git
  fi
fi
